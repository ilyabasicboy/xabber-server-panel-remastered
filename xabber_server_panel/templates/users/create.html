{% extends 'base.html' %}

{% block title %}
    Create new user
{% endblock %}

{% block content %}
    <div class="col-12">
        <form action="{% url 'users:create' %}" method="POST">
            {% csrf_token %}

            <div class="d-flex flex-column mb-4">
                <h4 class="text-secondary mt-0">
                    Credentials
                </h4>

                <div class="row mb-3">
                    <label class="col-form-label col-12 col-md-3 {% if form.username.errors %}text-danger{% endif %}">Username *</label>
                    <div class="col-12 col-md-9">
                        <div class="input-group">
                            <input class="form-control {% if form.username.errors %}is-invalid{% endif %}" type="text" name="username" placeholder="Username" {% if form.username.data %}value="{{ form.username.data }}"{% endif %}>

                            {% if hosts %}
                                <select class="form-select {% if hosts|length < 2 %}pe-none{% endif %}" name="host">

                                    {% for host in hosts %}
                                        <option value="{{ host.name }}"
                                                {% if form.host.data %}
                                                    {% if form.host.data == host.name %}selected{% endif %}
                                                {% elif current_host == host.name %}selected{% endif %}>
                                            @{{ host.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="row">
                    <label class="col-form-label col-12 col-md-3 {% if form.password.errors %}text-danger{% endif %}">Password *</label>
                    <div class="col-12 col-md-9">
                        <div class="input-group">
                            <input class="form-control {% if form.password.errors %}is-invalid{% endif %}" type="text" name="password" placeholder="Password" {% if form.password.data %}value="{{ form.password.data }}"{% endif %}>
                            <button class="btn btn-primary generate-password-js" type="button">Generate</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="d-flex flex-column mb-4">
                <h4 class="text-secondary mt-0">
                    User details
                </h4>

                <div class="row mb-3">
                    <label class="col-form-label col-12 col-md-3">Nickname</label>
                    <div class="col-12 col-md-9">
                        <input class="form-control" type="text" name="nickname" placeholder="John Doe" {% if form.password.data %}value="{{ form.nickname.data }}"{% endif %}>
                        <span class="form-text text-secondary">Nickname will be seen to user's contact.</span>
                    </div>
                </div>

                <div class="row mb-3">
                    <label class="col-form-label col-12 col-md-3">First name</label>
                    <div class="col-12 col-md-9">
                        <input class="form-control" type="text" name="first_name" placeholder="John" {% if form.first_name.data %}value="{{ form.first_name.data }}"{% endif %}>
                        <span class="form-text text-secondary">Permitted symbols are a..z, 0..9, dots and underscores.</span>
                    </div>
                </div>

                <div class="row mb-3">
                    <label class="col-form-label col-12 col-md-3">Last name</label>
                    <div class="col-12 col-md-9">
                        <input class="form-control" type="text" name="last_name" placeholder="Doe" {% if form.last_name.data %}value="{{ form.last_name.data }}"{% endif %}>
                        <span class="form-text text-secondary">Permitted symbols are a..z, 0..9, dots and underscores.</span>
                    </div>
                </div>

                <div class="row mb-3">
                    <label class="col-form-label col-12 col-md-3">Expires</label>
                    <div class="col-12 col-md-9">
                        <input class="form-control" type="date" name="expires_date" {% if form.expires.data %}value="{{ form.expires.data }}"{% endif %}>
                        <input class="form-control" type="time" name="expires_time" value="{{ form.expires.data|default:'12:00' }}">
                        <span class="form-text text-secondary">User expiration date.</span>
                    </div>
                </div>

                {% if request.user.is_admin %}
                    <div class="row mb-3">
                        <div class="col-12 col-md-3"></div>

                        <div class="col-12 col-md-9">
                            <div class="form-check mb-0">
                                <input class="form-check-input" type="checkbox" name="is_admin" id="is_admin">
                                <label class="form-check-label" for="is_admin">
                                    Administrator
                                </label>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>

            <button class="btn btn-primary" type="submit">Create user</button>
        </form>
    </div>
{% endblock %}