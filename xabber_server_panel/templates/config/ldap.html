{% extends 'base.html' %}
{% load config_tags %}

{% block content_title %}
    Server settings
{% endblock %}

{% block content %}
    {% url 'config:tabs' as url %}
    <div class="mb-4 col-12">
        {% include 'config/parts/links.html' %}
    </div>

    <div class="col-12 pb-5 mb-5">
        {% url 'config:tabs' as ldap %}
        <form class="check-change-js" method="post">
            {% csrf_token %}

            <div class="d-flex flex-column">
                <h4 class="text-secondary mt-0">
                    LDAP authentication
                </h4>

                {% if request.user.is_admin %}
                    <div class="row mb-3">
                        <label class="col-form-label col-12 col-md-3">
                            Host
                        </label>
                        <div class="col-12 col-md-9">
                            <select class="form-select nocheck-change-js {% if hosts.count < 2 %}pe-none{% endif %}" id="host" name="host" data-url="{{ url }}">
                                {% for host in hosts %}
                                    <option value="{{ host.id }}" {% if host.name == curr_host %}selected{% endif %}>
                                        {{ host.name }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                {% else %}
                    <input type="hidden" value="{{ hosts.first.id }}" name="host">
                {% endif %}
            </div>

            <div class="list-js" data-url="{{ url }}">
                {% include 'config/parts/ldap_fields.html' %}
            </div>
        </form>
    </div>
{% endblock %}