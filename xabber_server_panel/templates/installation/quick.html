{% extends 'base.html' %}
{% load static %}

{% block body %}
    <body class="d-flex flex-column min-vh-100 vh-100 bg-body bg-opacity-75">
        <div class="container flex-md-grow-1">
            <div class="row h-100">
                <main class="px-md-4 py-4">
                    <div class="d-flex align-items-center mb-4 fs-4">
                        <img src="{% static 'img/logo.png' %}" width="48" height="48" alt="Xabber">
                        Xabber server installation
                    </div>

                    <div class="col-12">
                        <form method="POST" novalidate>
                            {% csrf_token %}

                            <div class="bs-stepper">
                                <div class="bs-stepper-header flex-wrap flex-lg-nowrap mb-4" role="tablist">
                                    <div class="line"></div>
                                    <div class="step active">
                                        <button type="button" class="step-trigger">
                                            <span class="bs-stepper-label">Installation</span>
                                        </button>
                                    </div>
                                    <div class="line"></div>
                                </div>

                                <div class="bs-stepper-content">
                                    <div id="configure_admin" class="content {% if not installation_error %}active{% endif %}" role="tabpanel" aria-labelledby="configure_admin-trigger">
                                        <div class="col-12 col-lg-8 mx-auto">
                                            <div class="mb-4">
                                                <p>
                                                    Configure admin account for the server. It will be used to perform all administration and maintenance operations with the server. You will be able to chat using this account, you will also receive security alerts from the server. You will be able to configure additional admin accounts later.
                                                </p>
                                            </div>

                                            <div class="mb-3">
                                                <label class="form-label {% if form.username.errors %}text-danger{% endif %}">{{ form.username.label }}</label>
                                                <div class="input-group">
                                                    <input class="form-control {% if form.username.errors %}is-invalid{% endif %}" type="text" name="username" {% if form.username.data %}value="{{ form.username.data }}"{% endif %} placeholder="admin" maxlength="100" required="" id="id_username">
                                                    <span class="input-group-text">
                                                        @{{ form.data.host }}
                                                    </span>
                                                </div>
                                            </div>

                                            <div class="mb-3">
                                                <label class="form-label {% if form.password.errors %}text-danger{% endif %}">{{ form.password.label }}</label>
                                                <input class="form-control {% if form.password.errors %}is-invalid{% endif %}" type="password" name="password" {% if form.password.data %}value="{{ form.password.data }}"{% endif %} placeholder="Password" maxlength="100" required="" id="id_password">
                                            </div>

                                            <div class="d-flex justify-content-between align-items-center mt-4">
                                                <button class="btn btn-primary ms-auto" type="submit">
                                                    Next
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="installation" class="content {% if installation_error %}active{% endif %}" role="tabpanel" aria-labelledby="installation-trigger">
                                        <div class="col-12 col-lg-8 mx-auto">
                                            {% if installation_error %}
                                                <div class="mb-4 text-danger">
                                                    {{ installation_error }}
                                                </div>

                                                <div class="d-flex justify-content-between align-items-center mt-4">
                                                    <button class="btn btn-secondary mx-auto" type="submit" name="previous" value="1">
                                                        Back
                                                    </button>
                                                </div>
                                            {% else %}
                                                <button class="btn btn-success" type="submit" name="submit">
                                                    Submit
                                                </button>
                                                <div class="text-center">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Loading...</span>
                                                    </div>
                                                    <div class="mt-3">Waiting for installation...</div>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </main>
            </div>
        </div>
    </body>
{% endblock %}